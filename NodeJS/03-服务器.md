# 简易服务器

## 1. 简易服务器

```js
import { createServer } from "node:http"; // http 模块
import { readFile } from "node:fs/promises"; // 读取文件的 fs 模块

// 创建服务器
const server = createServer(async (req, res) => {
  res.statusCode = 200; // 设置状态码
  res.setHeader("Content-Type", "text/html"); // 设置返回类型（可以去浏览器搜索对应的格式）

  const htmlFile = await readFile("./example.html", "utf-8");
  res.end(htmlFile); // 返回的数据
});

// 监听 端口 主机地址
server.listen(3000, "127.0.0.1", () => {
  console.log("Server running at http://127.0.0.1:3000/");
});
```

## 2. 路由

通过 `if`判断，改变 `req.url`

```js
import { createServer } from "node:http";
import { readFile } from "node:fs/promises";

const server = createServer(async (req, res) => {
  res.statusCode = 200;

  // 根目录
  if (req.url === "/") {
    res.setHeader("Content-Type", "text/html");
    const htmlFile = await readFile("./file/example.html", "utf-8");
    res.end(htmlFile);
  }

  // JSON 文件
  else if (req.url === "/data.json") {
    res.setHeader("Content-Type", "application/json");
    const data = await readFile("./file/data.json", "utf-8");
    res.end(data);
  }

  // 404
  else {
    res.setHeader("Content-Type", "text/html");
    const htmlFile = await readFile("./file/404.html", "utf-8");
    res.end(htmlFile);
  }
});

server.listen(3000, "127.0.0.1", () => {
  console.log("Server running at http://127.0.0.1:3000/");
});
```

## 3. SPA 与 SSR

1. SSR
   - 服务端渲染，占用资源多，即前端和数据都交给同一个服务器处理
2. SPA（单页面应用）
   - 分为 Web Server 和 Application Server，加载可能较慢，但是是一个更优的选择
